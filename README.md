# Домашнее задание к занятию `PostgreSQL` - `Алаев Марат`


### Задача 1

Используя Docker, поднимите инстанс PostgreSQL (версию 13). Данные БД сохраните в volume.

Подключитесь к БД PostgreSQL, используя psql.

Воспользуйтесь командой \? для вывода подсказки по имеющимся в psql управляющим командам.

Найдите и приведите управляющие команды для:

вывода списка БД,

подключения к БД,

вывода списка таблиц,

вывода описания содержимого таблиц,

выхода из psql.

___


\l

\conninfo

\dp

\d+ table

\q




### Задача 2
Используя psql, создайте БД test_database.

Изучите бэкап БД.

Восстановите бэкап БД в test_database.

Перейдите в управляющую консоль psql внутри контейнера.

Подключитесь к восстановленной БД и проведите операцию ANALYZE для сбора статистики по таблице.

Используя таблицу pg_stats, найдите столбец таблицы orders с наибольшим средним значением размера элементов в байтах.

Приведите в ответе команду, которую вы использовали для вычисления, и полученный результат.

___

```SQL
select attname ,avg_width from pg_stats where tablename = 'orders'
ORDER BY avg_width DESC
LIMIT 1
```

![image](https://github.com/MaratAlaev/gitlab-hw/assets/46092593/8883d9d4-b536-43b5-a9bd-7c097379944d)






### Задача 3
Архитектор и администратор БД выяснили, что ваша таблица orders разрослась до невиданных размеров и поиск по ней занимает долгое время. Вам как успешному выпускнику курсов DevOps в Нетологии предложили провести разбиение таблицы на 2: шардировать на orders_1 - price>499 и orders_2 - price<=499.

Предложите SQL-транзакцию для проведения этой операции.

Можно ли было изначально исключить ручное разбиение при проектировании таблицы orders?

___

```SQL
CREATE table orders_1 (
    Check(price > 499)
) inherits(orders)
```
```SQL
CREATE table orders_2 (
    Check(price <= 499)
) inherits(orders)
```

да, с помощью правил. мы могли бы также вручную создать две таблицы наследника 
а после с помощью правил сделать так чтобы при определенной вставке данные бы отправлялись в разные таблицы 

### Задача 4

Используя утилиту pg_dump, создайте бекап БД test_database.

Как бы вы доработали бэкап-файл, чтобы добавить уникальность значения столбца title для таблиц test_database?

___

С помощью создания уникальных ограничений  CONSTRAINT name UNIQUE
в таком случае мы не сможем добавлять не уникальные значения для поля title 
